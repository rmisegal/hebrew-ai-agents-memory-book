\hebrewsection{מבנים מתמטיים לייצוג מערכות רב-סוכנים}

לאחר שחקרנו בפרקים \num{3}–\num{5} את הבניה המעשית של סוכני \en{AI} אוטונומיים, את שילובם עם \en{Claude CLI}, ואת פרוטוקול התקשורת \en{MCP}, הגיע הזמן להרחיב את ההבנה שלנו למימד מתמטי. פרק זה מציג כלים פורמליים מתורת הגרפים ואלגברה לינארית המאפשרים לנתח מערכות רב-סוכנים באופן כמותי – לבחון יציבותן, לזהות צווארי בקבוק, ולהבין את זרימת המידע ביניהן. הדוגמאות יתבססו על מערכת ה\en{-Gmail MCP} שפיתחנו, כדי לחבר את המופשט למוחשי.

\hebrewsubsection{ייצוג רשת הסוכנים כגרף וכמטריצה}

מערכת רב-סוכנים ניתן לתאר באופן טבעי כגרף מכוון: כל צומת מייצג סוכן, וקשתות מייצגות זרימת מידע מסוכן אחד למשנהו. מבנה גרפי זה מאפשר לנתח את המערכת בכלים מתמטיים של תורת הגרפים ואלגברה לינארית. לדוגמה, נשקול מערכת עם $\num{3}$ סוכנים $S_1, S_2, S_3$. נניח שהפלט של $S_1$ מוזן כקלט ל\en{-}$S_2$, הפלט של $S_2$ מוזן ל\en{-}$S_3$, והפלט של $S_3$ חוזר ומשמש כקלט ל\en{-}$S_1$ (כלומר, מעגל סגור של שלושה סוכנים). נוכל לתאר רשת זו באמצעות מטריצת סמיכויות $A$ בגודל $\num{3}\times \num{3}$:
\[
A = \begin{pmatrix}
\num{0} & \num{1} & \num{0}\\
\num{0} & \num{0} & \num{1}\\
\num{1} & \num{0} & \num{0}
\end{pmatrix},
\]
כאשר $A_{ij}=\num{1}$ אם מידע עובר מהסוכן $S_j$ לסוכן $S_i$. בדוגמה שלנו, $A_{21}=\num{1}$ (פלט $S_1$ מגיע לסוכן $S_2$), $A_{32}=\num{1}$ (פלט $S_2$ מגיע ל\en{-}$S_3$), $A_{13}=\num{1}$ (פלט $S_3$ חוזר ל\en{-}$S_1$), ושאר הערכים אפס.

מטריצת סמיכויות זו מראה שקיים מחזור באורך \num{3} במערכת (ניתן לראות שהעלאת $A$ בחזקת \num{3} תניב מטריצה עם ערכים חיוביים באלכסון – סימן למסלול חזרה לכל סוכן). בעזרת כלים גרפיים, נוכל לבחון תכונות כמו \textbf{קישוריות} (למשל, האם כל סוכן משפיע בסופו של דבר על כל האחרים) ו\textbf{צווארי בקבוק} בזרימת המידע (זיהוי סוכן יחיד שעליו עוברים נתונים רבים במיוחד). עבור מערכות גדולות ומורכבות, ניתוח גרפי יכול לסייע לזהות מבנים כמו רכיבי קשירות (\en{subnetworks}) או מרכזיות של סוכנים מסוימים, ובכך לכוון אופטימיזציות – למשל, פישוט רשת על-ידי הסרת סוכנים מיותרים או הוספת קישורים ישירים להפחתת עומס.

\textbf{דוגמה מעשית – מערכת \en{Gmail MCP} שלנו:} במערכת שפיתחנו בפרק \num{3}, אם נתייחס לסוכן ה\en{-MCP} כצומת מרכזי ($S_{\text{MCP}}$), ל\en{-Claude} כצומת מתווך ($S_{\text{Claude}}$), ולמשתמש כצומת חיצוני ($S_{\text{User}}$), נוכל לייצג את זרימת המידע כגרף מכוון: המשתמש שולח בקשה ל\en{-Claude} ← \en{Claude} קורא לכלי \en{MCP} ← סוכן ה\en{-MCP} מבצע חיפוש ב\en{-Gmail} ← התוצאה חוזרת ל\en{-Claude} ← \en{Claude} מעבד ושולח תשובה למשתמש. מטריצת הסמיכויות תראה זרימה ליניארית עם משוב סגור (המשתמש יכול לשלוח בקשה נוספת על בסיס התשובה). ניתוח כזה חושף ש\en{-Claude} הוא צומת ביניים קריטי – צוואר בקבוק פוטנציאלי שכל התקשורת עוברת דרכו. אם נוסיף סוכן נוסף (למשל, סוכן קלנדר), נוכל לראות איך הגרף מתרחב ואיך נוצר קישור ישיר בין הסוכנים אם הם משתפים מידע.

\hebrewsubsection{הרכבת טרנספורמציות לינאריות וניתוח יציבות}

דרך מתמטית נוספת לנתח מערכת רב-סוכנית היא לראות בכל סוכן אופרטור (בדרך כלל לא לינארי) על מרחב מצבים או מרחב מידע. לצורך אינטואיציה, נניח שבתחום פעולה מוגבל ניתן לקרב את פעולת הסוכן כטרנספורמציה לינארית $W_i$ על וקטור מצב $\mathbf{x}$. אם תהליך מבוצע ברצף על-ידי סוכנים $S_1, S_2, \dots, S_n$, אפשר לתאר את ההשפעה המצטברת כמכפלת אופרטורים:
\[
W_{\text{total}} \;=\; W_n \cdot W_{n-1} \cdots W_1,
\]
כך שאם $\mathbf{x}_{\text{in}}$ הוא וקטור הכניסה לתהליך, אזי הווקטור בסיום התהליך יהיה $\mathbf{x}_{\text{out}} = W_{\text{total}}\, \mathbf{x}_{\text{in}}$. פירושו של דבר שהרכבת פעולות הסוכנים שקולה מתמטית להרכבת הפונקציות שלהן. ניתוח ספקטרלי של המטריצה $W_{\text{total}}$ עשוי לתת תובנות על יציבות המערכת: למשל, אם למטריצה זו יש ערך עצמי (\en{eigenvalue}) גדול מ\en{-}\num{1} במונחי ערך מוחלט, המערכת עלולה להיות לא יציבה (כלומר, שגיאה קטנה בכניסה תגדל אחרי מעבר בסדרה של סוכנים). לעומת זאת, אם כל הערכים העצמיים בעלי ערך מוחלט קטן מ\en{-}\num{1}, אז המערכת שואפת לדעוך ולהגיע לשיווי משקל (מצב יציב). בפועל, פעולות הסוכנים הן בלתי-לינאריות (שכן סוכן \en{AI} כולל רשתות נוירונים או לוגיקה מורכבת אחרת), אך ניתוח לינארי מקומי כזה – בדומה ללינאריזציה של מערכות דינמיות – יכול לספק קירוב להבנת התנהגות המערכת סביב נקודת פעולה מסוימת.

ייצוג מבוסס-וקטורים עוזר גם להבין כיצד מידע מתפלג בין הסוכנים. אפשר לחשוב על כל סוכן כמקרין את הקלט שלו לתת-מרחב ספציפי. למשל, ייתכן שסוכן אחד מחשב וקטור מאפיינים $\mathbf{y} = P\,\mathbf{x}$ מתוך קלט $\mathbf{x}$, כאשר $P$ היא מטריצת הקרנה הבוחרת רכיבים הרלוונטיים למשימתו. סוכן אחר עשוי לקבל שני וקטורי קלט משני סוכנים קודמים ולשלבם: $\mathbf{z} = Q_1 \mathbf{y}_1 + Q_2 \mathbf{y}_2$. במקרה כזה אפשר לראות את $\mathbf{z}$ כתוצאה של מכפלה במטריצה משולבת $Q$ על וקטור מאוחד $[\mathbf{y}_1;\mathbf{y}_2]$. תיאור אלגברי זה מאפשר לזהות למשל תלות לינארית בין פלטים של סוכנים שונים – אם נמצא שמקטעי וקטור שפלט סוכן אחד הם צירוף לינארי של פלט משנהו, ניתן אולי לפשט את המערכת על-ידי ביטול סוכן מיותר או איחוד תפקידים.

\textbf{יישום במערכת \en{Gmail}:} בסוכן ה\en{-MCP} שלנו, אפשר לחשוב על קלט המשתמש (בקשת חיפוש) כווקטור $\mathbf{x}_{\text{query}}$ במרחב של מילות מפתח ופרמטרים. הסוכן מבצע טרנספורמציה $W_{\text{search}}$ שממפה את הבקשה לשאילתת \en{Gmail API}. התוצאה (רשימת אימיילים) היא וקטור במרחב מסרים $\mathbf{y}_{\text{emails}}$. כעת, \en{Claude} מבצע טרנספורמציה נוספת $W_{\text{summarize}}$ שממפה את הרשימה לתשובה טקסטואלית $\mathbf{z}_{\text{response}}$. ההרכבה $W_{\text{total}} = W_{\text{summarize}} \cdot W_{\text{search}}$ מייצגת את זרם העיבוד המלא מהבקשה ועד התשובה. אם בשלב כלשהו הטרנספורמציה מגדילה את "גודל" הפלט באופן לא מבוקר (למשל, שאילתה משיבה אלפי אימיילים שמציפים את \en{Claude}), מדובר בערך עצמי גדול מ\en{-}\num{1} במובן זה – אינדיקציה לחוסר יציבות שיש לטפל בה (למשל, על-ידי הגבלת מספר התוצאות או סינון מוקדם).

מעניין לציין שאפשר למסגר מערכת רב-סוכנים גם במסגרת מתמטית מופשטת יותר, למשל תורת הקטגוריות: הסוכנים יכולים להיחשב כאובייקטים בקטגוריה, והאינטראקציות ביניהם – כפונקטורים (מורפיזמים). הרכבת מורפיזמים מתאימה בדיוק להפעלת סוכנים ברצף. גישה אבסטרקטית זו, אף כי היא מעבר לטווח דיוננו כאן, רומזת על האפשרות לפתח "שפה" מתמטית כללית לאפיון מערכות \en{AI} מבוזרות ולהוכחת תכונותיהן.

לסיכום, ניתוח מערכות רב-סוכנים בכלים מתמטיים – בין אם באמצעות גרפים, מטריצות או מודלים אלגבריים אחרים – מספק מבט נוסף ומעמיק על פעולתן. כלים אלה מאפשרים לנו להסיק מסקנות תיאורטיות על יעילות, יציבות ועמידות המערכת, ומשלימים את ההבנה האיכותנית וההנדסית שגיבשנו בפרקים הקודמים על עידן הסוכנים האוטונומיים. המערכת המעשית ש בנינו – החל מהשלב האתי (פרק \num{2}), דרך המימוש הטכני (פרקים \num{3}–\num{5}), ועד לתיאור המתמטי שראינו כאן – מעידה על כך שפיתוח סוכני \en{AI} אחראיים ויעילים דורש אינטגרציה של משמעת הנדסית, מודעות אתית וחשיבה מופשטת כאחד.
